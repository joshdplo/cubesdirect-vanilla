<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('../../partials/head'); %>
</head>

<body>
  <%- include ('../../partials/header') %>

  <main>
    <h1>Cart</h1>
    <% if (items.length) { %>
    <ul>
      <% items.forEach(item => {%>
      <li>
        <img src="<%= item.Product.images[0] %>" alt="<%= item.Product.name %>" width="100">
        <div><%= item.Product.name %></div>
        <div>Price: $<%= item.Product.price %></div>
        <%# @TODO: move cart api calls into a script %>
        <form id="cart-item-update" action="/api/cart/update" method="POST">
          <input type="hidden" name="cartItemId" id="cartItemId" value="<%= item.id %>">
          <input type="number" name="quantity" id="quantity" value="<%= item.quantity %>" min="1" max="100">
          <input type="submit" value="Update">
        </form>
        <form id="cart-item-remove" action="/api/cart/remove" method="POST">
          <input type="hidden" name="cartItemId" id="cartItemId" value="<%= item.id %>">
          <input type="submit" value="Remove">
        </form>
        <div class="cart-form-message"></div>
      </li>
      <% }); %>
      <hr>
      <h2>Subtotal: $<%= subtotal.toFixed(2) %></h2>
      <br><br>
      <a href="/checkout">Proceed to Checkout</a>
    </ul>
    <% } else { %>
    <p>There are currently no products in your cart.</p>
    <% } %>
  </main>

  <%- include ('../../partials/footer') %>
  <%- include ('../../partials/end') %>
</body>

</html>